!function($){
    "use strict";

    var hiSlide = function(element, options) {
        var $element = $(element),
            settings = $.extend({}, $.fn.hiSlide.defaults, options),
            slides = [],
            currentSlide = 0;

        function init() {
            createSlides();
            setupEventListeners();
            startAnimation();
        }

        function createSlides() {
            // Crea objetos de configuraci√≥n para cada diapositiva
            slides = [
                {$zIndex: 1, width: 120, height: 150, top: 69, left: 134, $opacity: 0.2},
                {$zIndex: 2, width: 130, height: 170, top: 59, left: 0, $opacity: 0.4},
                {$zIndex: 3, width: 170, height: 218, top: 35, left: 110, $opacity: 0.7},
                {$zIndex: 4, width: 224, height: 288, top: 0, left: 263, $opacity: 1},
                {$zIndex: 3, width: 170, height: 218, top: 35, left: 470, $opacity: 0.7},
                {$zIndex: 2, width: 130, height: 170, top: 59, left: 620, $opacity: 0.4},
                {$zIndex: 1, width: 120, height: 150, top: 69, left: 500, $opacity: 0.2}
            ];
        }

        function setupEventListeners() {
            $element.find(".hi-next").on("click", nextSlide);
            $element.find(".hi-prev").on("click", prevSlide);
            $element.on("mouseenter", pauseAnimation);
            $element.on("mouseleave", resumeAnimation);
        }

        function startAnimation() {
            animateCurrentSlide();
            setInterval(nextSlide, settings.interval);
        }

        function animateCurrentSlide() {
            var current = slides[currentSlide];
            $element.find("li").css({
                zIndex: current.$zIndex,
                width: current.width,
                height: current.height,
                top: current.top,
                left: current.left,
                opacity: current.$opacity
            }).finish().animate(current, settings.speed);
        }

        function nextSlide() {
            currentSlide = (currentSlide + 1) % slides.length;
            animateCurrentSlide();
        }

        function prevSlide() {
            currentSlide = (currentSlide - 1 + slides.length) % slides.length;
            animateCurrentSlide();
        }

        function pauseAnimation() {
            clearInterval(settings.intervalId);
            settings.intervalId = null;
        }

        function resumeAnimation() {
            if (!settings.intervalId) {
                settings.intervalId = setInterval(nextSlide, settings.interval);
            }
        }

        return this.each(init);
    };

    $.fn.hiSlide = function(options) {
        return this.each(function() {
            new hiSlide(this, options);
        });
    };

    $.fn.hiSlide.defaults = {
        speed: 1000,
        interval: 2000
    };
}(jQuery);
